{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Container,Card,Button,Row,Col}from'react-bootstrap';import{useQuery,useMutation}from'@apollo/client';import Auth from'../utils/auth';import{removeBookId}from'../utils/localStorage';import{GET_ME}from'../utils/queries';import{REMOVE_BOOK}from'../utils/mutations';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const SavedBooks=()=>{const{data:userData,loading:userLoading,error:userError}=useQuery(GET_ME);const[removeBook,{data:removeData,loading:removeLoading,error:removeError}]=useMutation(REMOVE_BOOK);// create function that accepts the book's mongo _id value as param and deletes the book from the database\nconst handleDeleteBook=async bookId=>{const token=Auth.loggedIn()?Auth.getToken():null;if(!token){throw new Error('You are not authenticated to remove a book!');}try{// const { data: updatedUser } = await removeBook({ variables: { bookId }, context: { headers: { Authorization: `Bearer ${token}` } } });\nconst{data}=await removeBook({variables:{bookId},context:{headers:{Authorization:`Bearer ${token}`}}});}catch(err){console.error(err);throw new Error(`An error occurred removing the book! Error message: ${err.message}`);}};if(userLoading){return/*#__PURE__*/_jsx(\"h2\",{children:\"Loading...\"});}else if(userError||!userData){console.error(userError);}// if data isn't here yet, say so\nif(removeLoading){return/*#__PURE__*/_jsx(\"h2\",{children:\"LOADING...\"});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{fluid:true,className:\"text-light bg-dark p-5\",children:/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsx(\"h1\",{children:\"Viewing saved books!\"})})}),/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"pt-5\",children:userData.me.savedBooks.length?`Viewing ${userData.me.savedBooks.length} saved ${userData.me.savedBooks.length===1?'book':'books'}:`:'You have no saved books!'}),/*#__PURE__*/_jsx(Row,{children:userData.me.savedBooks.map(book=>{return/*#__PURE__*/_jsx(Col,{md:\"4\",children:/*#__PURE__*/_jsxs(Card,{border:\"dark\",children:[book.image?/*#__PURE__*/_jsx(Card.Img,{src:book.image,alt:`The cover for ${book.title}`,variant:\"top\"}):null,/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(Card.Title,{children:book.title}),/*#__PURE__*/_jsxs(\"p\",{className:\"small\",children:[\"Authors: \",book.authors]}),/*#__PURE__*/_jsx(Card.Text,{children:book.description}),/*#__PURE__*/_jsx(Button,{className:\"btn-block btn-danger\",onClick:()=>handleDeleteBook(book.bookId),children:\"Delete this Book!\"})]})]},book.bookId)});})})]})]});};export default SavedBooks;","map":{"version":3,"names":["React","useState","useEffect","Container","Card","Button","Row","Col","useQuery","useMutation","Auth","removeBookId","GET_ME","REMOVE_BOOK","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","SavedBooks","data","userData","loading","userLoading","error","userError","removeBook","removeData","removeLoading","removeError","handleDeleteBook","bookId","token","loggedIn","getToken","Error","variables","context","headers","Authorization","err","console","message","children","fluid","className","me","savedBooks","length","map","book","md","border","image","Img","src","alt","title","variant","Body","Title","authors","Text","description","onClick"],"sources":["C:/Users/jared/PortfolioProjects/BookwormSE/Develop/client/src/pages/SavedBooks.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Container, Card, Button, Row, Col } from 'react-bootstrap';\r\nimport {useQuery, useMutation } from '@apollo/client';\r\nimport Auth from '../utils/auth';\r\nimport { removeBookId } from '../utils/localStorage';\r\nimport { GET_ME } from '../utils/queries';\r\nimport { REMOVE_BOOK } from '../utils/mutations';\r\n\r\nconst SavedBooks = () => {\r\n  const { data: userData, loading: userLoading, error: userError } = useQuery(GET_ME);\r\n  \r\nconst [removeBook, { data: removeData, loading: removeLoading, error: removeError }] = useMutation(REMOVE_BOOK);\r\n\r\n  // create function that accepts the book's mongo _id value as param and deletes the book from the database\r\n  const handleDeleteBook = async (bookId) => {\r\n    const token = Auth.loggedIn() ? Auth.getToken() : null;\r\n\r\n    if (!token) {\r\n      throw new Error('You are not authenticated to remove a book!');\r\n    }\r\n\r\n    try {\r\n      // const { data: updatedUser } = await removeBook({ variables: { bookId }, context: { headers: { Authorization: `Bearer ${token}` } } });\r\n\r\n       const { data } = await removeBook({\r\n         variables: { bookId },\r\n         context: { headers: { Authorization: `Bearer ${token}` } },\r\n       });\r\n\r\n    } catch (err) {\r\n      console.error(err);\r\n        throw new Error(`An error occurred removing the book! Error message: ${err.message}`);\r\n    }\r\n  };\r\n\r\n    \r\n  if (userLoading) {\r\n    return <h2>Loading...</h2>;\r\n  } else if (userError || !userData) {\r\n    console.error(userError);\r\n  }\r\n\r\n  // if data isn't here yet, say so\r\n  if (removeLoading) {\r\n    return <h2>LOADING...</h2>;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div fluid className='text-light bg-dark p-5'>\r\n        <Container>\r\n          <h1>Viewing saved books!</h1>\r\n        </Container>\r\n      </div>\r\n      <Container>\r\n        <h2 className='pt-5'>\r\n          {userData.me.savedBooks.length\r\n            ? `Viewing ${userData.me.savedBooks.length} saved ${userData.me.savedBooks.length === 1 ? 'book' : 'books'}:`\r\n            : 'You have no saved books!'}\r\n        </h2>\r\n        <Row>\r\n          {userData.me.savedBooks.map((book) => {\r\n            return (\r\n              <Col md=\"4\">\r\n                <Card key={book.bookId} border='dark'>\r\n                  {book.image ? <Card.Img src={book.image} alt={`The cover for ${book.title}`} variant='top' /> : null}\r\n                  <Card.Body>\r\n                    <Card.Title>{book.title}</Card.Title>\r\n                    <p className='small'>Authors: {book.authors}</p>\r\n                    <Card.Text>{book.description}</Card.Text>\r\n                    <Button className='btn-block btn-danger' onClick={() => handleDeleteBook(book.bookId)}>\r\n                      Delete this Book!\r\n                    </Button>\r\n                  </Card.Body>\r\n                </Card>\r\n              </Col>\r\n            );\r\n          })}\r\n        </Row>\r\n      </Container>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default SavedBooks;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,OAASC,SAAS,CAAEC,IAAI,CAAEC,MAAM,CAAEC,GAAG,CAAEC,GAAG,KAAQ,iBAAiB,CACnE,OAAQC,QAAQ,CAAEC,WAAW,KAAQ,gBAAgB,CACrD,MAAO,CAAAC,IAAI,KAAM,eAAe,CAChC,OAASC,YAAY,KAAQ,uBAAuB,CACpD,OAASC,MAAM,KAAQ,kBAAkB,CACzC,OAASC,WAAW,KAAQ,oBAAoB,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,gCAAAC,QAAA,IAAAC,SAAA,yBAEjD,KAAM,CAAAC,UAAU,CAAGA,CAAA,GAAM,CACvB,KAAM,CAAEC,IAAI,CAAEC,QAAQ,CAAEC,OAAO,CAAEC,WAAW,CAAEC,KAAK,CAAEC,SAAU,CAAC,CAAGlB,QAAQ,CAACI,MAAM,CAAC,CAErF,KAAM,CAACe,UAAU,CAAE,CAAEN,IAAI,CAAEO,UAAU,CAAEL,OAAO,CAAEM,aAAa,CAAEJ,KAAK,CAAEK,WAAY,CAAC,CAAC,CAAGrB,WAAW,CAACI,WAAW,CAAC,CAE7G;AACA,KAAM,CAAAkB,gBAAgB,CAAG,KAAO,CAAAC,MAAM,EAAK,CACzC,KAAM,CAAAC,KAAK,CAAGvB,IAAI,CAACwB,QAAQ,CAAC,CAAC,CAAGxB,IAAI,CAACyB,QAAQ,CAAC,CAAC,CAAG,IAAI,CAEtD,GAAI,CAACF,KAAK,CAAE,CACV,KAAM,IAAI,CAAAG,KAAK,CAAC,6CAA6C,CAAC,CAChE,CAEA,GAAI,CACF;AAEC,KAAM,CAAEf,IAAK,CAAC,CAAG,KAAM,CAAAM,UAAU,CAAC,CAChCU,SAAS,CAAE,CAAEL,MAAO,CAAC,CACrBM,OAAO,CAAE,CAAEC,OAAO,CAAE,CAAEC,aAAa,CAAG,UAASP,KAAM,EAAE,CAAE,CAC3D,CAAC,CAAC,CAEL,CAAE,MAAOQ,GAAG,CAAE,CACZC,OAAO,CAACjB,KAAK,CAACgB,GAAG,CAAC,CAChB,KAAM,IAAI,CAAAL,KAAK,CAAE,uDAAsDK,GAAG,CAACE,OAAQ,EAAC,CAAC,CACzF,CACF,CAAC,CAGD,GAAInB,WAAW,CAAE,CACf,mBAAOT,IAAA,OAAA6B,QAAA,CAAI,YAAU,CAAI,CAAC,CAC5B,CAAC,IAAM,IAAIlB,SAAS,EAAI,CAACJ,QAAQ,CAAE,CACjCoB,OAAO,CAACjB,KAAK,CAACC,SAAS,CAAC,CAC1B,CAEA;AACA,GAAIG,aAAa,CAAE,CACjB,mBAAOd,IAAA,OAAA6B,QAAA,CAAI,YAAU,CAAI,CAAC,CAC5B,CAEA,mBACE3B,KAAA,CAAAE,SAAA,EAAAyB,QAAA,eACE7B,IAAA,QAAK8B,KAAK,MAACC,SAAS,CAAC,wBAAwB,CAAAF,QAAA,cAC3C7B,IAAA,CAACZ,SAAS,EAAAyC,QAAA,cACR7B,IAAA,OAAA6B,QAAA,CAAI,sBAAoB,CAAI,CAAC,CACpB,CAAC,CACT,CAAC,cACN3B,KAAA,CAACd,SAAS,EAAAyC,QAAA,eACR7B,IAAA,OAAI+B,SAAS,CAAC,MAAM,CAAAF,QAAA,CACjBtB,QAAQ,CAACyB,EAAE,CAACC,UAAU,CAACC,MAAM,CACzB,WAAU3B,QAAQ,CAACyB,EAAE,CAACC,UAAU,CAACC,MAAO,UAAS3B,QAAQ,CAACyB,EAAE,CAACC,UAAU,CAACC,MAAM,GAAK,CAAC,CAAG,MAAM,CAAG,OAAQ,GAAE,CAC3G,0BAA0B,CAC5B,CAAC,cACLlC,IAAA,CAACT,GAAG,EAAAsC,QAAA,CACDtB,QAAQ,CAACyB,EAAE,CAACC,UAAU,CAACE,GAAG,CAAEC,IAAI,EAAK,CACpC,mBACEpC,IAAA,CAACR,GAAG,EAAC6C,EAAE,CAAC,GAAG,CAAAR,QAAA,cACT3B,KAAA,CAACb,IAAI,EAAmBiD,MAAM,CAAC,MAAM,CAAAT,QAAA,EAClCO,IAAI,CAACG,KAAK,cAAGvC,IAAA,CAACX,IAAI,CAACmD,GAAG,EAACC,GAAG,CAAEL,IAAI,CAACG,KAAM,CAACG,GAAG,CAAG,iBAAgBN,IAAI,CAACO,KAAM,EAAE,CAACC,OAAO,CAAC,KAAK,CAAE,CAAC,CAAG,IAAI,cACpG1C,KAAA,CAACb,IAAI,CAACwD,IAAI,EAAAhB,QAAA,eACR7B,IAAA,CAACX,IAAI,CAACyD,KAAK,EAAAjB,QAAA,CAAEO,IAAI,CAACO,KAAK,CAAa,CAAC,cACrCzC,KAAA,MAAG6B,SAAS,CAAC,OAAO,CAAAF,QAAA,EAAC,WAAS,CAACO,IAAI,CAACW,OAAO,EAAI,CAAC,cAChD/C,IAAA,CAACX,IAAI,CAAC2D,IAAI,EAAAnB,QAAA,CAAEO,IAAI,CAACa,WAAW,CAAY,CAAC,cACzCjD,IAAA,CAACV,MAAM,EAACyC,SAAS,CAAC,sBAAsB,CAACmB,OAAO,CAAEA,CAAA,GAAMlC,gBAAgB,CAACoB,IAAI,CAACnB,MAAM,CAAE,CAAAY,QAAA,CAAC,mBAEvF,CAAQ,CAAC,EACA,CAAC,GATHO,IAAI,CAACnB,MAUV,CAAC,CACJ,CAAC,CAEV,CAAC,CAAC,CACC,CAAC,EACG,CAAC,EACZ,CAAC,CAEP,CAAC,CAED,cAAe,CAAAZ,UAAU"},"metadata":{},"sourceType":"module","externalDependencies":[]}