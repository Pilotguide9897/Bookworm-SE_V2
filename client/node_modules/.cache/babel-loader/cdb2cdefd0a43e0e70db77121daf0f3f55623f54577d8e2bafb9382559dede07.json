{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/jared/PortfolioProjects/BookwormSE/Develop/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/jared/PortfolioProjects/BookwormSE/Develop/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/jared/PortfolioProjects/BookwormSE/Develop/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{Container,Card,Button,Row,Col}from'react-bootstrap';import{useQuery,useMutation}from'@apollo/client';import Auth from'../utils/auth';import{removeBookId}from'../utils/localStorage';import{GET_ME}from'../utils/queries';import{REMOVE_BOOK}from'../utils/mutations';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var SavedBooks=function SavedBooks(){var _useQuery=useQuery(GET_ME),userData=_useQuery.data,userLoading=_useQuery.loading,userError=_useQuery.error;var _useMutation=useMutation(REMOVE_BOOK),_useMutation2=_slicedToArray(_useMutation,2),removeBook=_useMutation2[0],_useMutation2$=_useMutation2[1],removeData=_useMutation2$.data,removeLoading=_useMutation2$.loading,removeError=_useMutation2$.error;// create function that accepts the book's mongo _id value as param and deletes the book from the database\nvar handleDeleteBook=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(bookId){var token,_yield$removeBook,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:token=Auth.loggedIn()?Auth.getToken():null;if(token){_context.next=3;break;}throw new Error('You are not authenticated to remove a book!');case 3:_context.prev=3;_context.next=6;return removeBook({variables:{bookId:bookId},context:{headers:{Authorization:\"Bearer \".concat(token)}}});case 6:_yield$removeBook=_context.sent;data=_yield$removeBook.data;_context.next=14;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](3);console.error(_context.t0);throw new Error(\"An error occurred removing the book! Error message: \".concat(_context.t0.message));case 14:case\"end\":return _context.stop();}},_callee,null,[[3,10]]);}));return function handleDeleteBook(_x){return _ref.apply(this,arguments);};}();if(userLoading){return/*#__PURE__*/_jsx(\"h2\",{children:\"Loading...\"});}else if(userError||!userData){console.error(userError);}// if data isn't here yet, say so\nif(removeLoading){return/*#__PURE__*/_jsx(\"h2\",{children:\"LOADING...\"});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{fluid:true,className:\"text-light bg-dark p-5\",children:/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsx(\"h1\",{children:\"Viewing saved books!\"})})}),/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"pt-5\",children:userData.me.savedBooks.length?\"Viewing \".concat(userData.me.savedBooks.length,\" saved \").concat(userData.me.savedBooks.length===1?'book':'books',\":\"):'You have no saved books!'}),/*#__PURE__*/_jsx(Row,{children:userData.me.savedBooks.map(function(book){return/*#__PURE__*/_jsx(Col,{md:\"4\",children:/*#__PURE__*/_jsxs(Card,{border:\"dark\",children:[book.image?/*#__PURE__*/_jsx(Card.Img,{src:book.image,alt:\"The cover for \".concat(book.title),variant:\"top\"}):null,/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(Card.Title,{children:book.title}),/*#__PURE__*/_jsxs(\"p\",{className:\"small\",children:[\"Authors: \",book.authors]}),/*#__PURE__*/_jsx(Card.Text,{children:book.description}),/*#__PURE__*/_jsx(Button,{className:\"btn-block btn-danger\",onClick:function onClick(){return handleDeleteBook(book.bookId);},children:\"Delete this Book!\"})]})]},book.bookId)});})})]})]});};export default SavedBooks;","map":{"version":3,"names":["React","useState","useEffect","Container","Card","Button","Row","Col","useQuery","useMutation","Auth","removeBookId","GET_ME","REMOVE_BOOK","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","SavedBooks","_useQuery","userData","data","userLoading","loading","userError","error","_useMutation","_useMutation2","_slicedToArray","removeBook","_useMutation2$","removeData","removeLoading","removeError","handleDeleteBook","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","bookId","token","_yield$removeBook","wrap","_callee$","_context","prev","next","loggedIn","getToken","Error","variables","context","headers","Authorization","concat","sent","t0","console","message","stop","_x","apply","arguments","children","fluid","className","me","savedBooks","length","map","book","md","border","image","Img","src","alt","title","variant","Body","Title","authors","Text","description","onClick"],"sources":["C:/Users/jared/PortfolioProjects/BookwormSE/Develop/client/src/pages/SavedBooks.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Container, Card, Button, Row, Col } from 'react-bootstrap';\r\nimport {useQuery, useMutation } from '@apollo/client';\r\nimport Auth from '../utils/auth';\r\nimport { removeBookId } from '../utils/localStorage';\r\nimport { GET_ME } from '../utils/queries';\r\nimport { REMOVE_BOOK } from '../utils/mutations';\r\n\r\nconst SavedBooks = () => {\r\n  const { data: userData, loading: userLoading, error: userError } = useQuery(GET_ME);\r\n  \r\nconst [removeBook, { data: removeData, loading: removeLoading, error: removeError }] = useMutation(REMOVE_BOOK);\r\n\r\n  // create function that accepts the book's mongo _id value as param and deletes the book from the database\r\n  const handleDeleteBook = async (bookId) => {\r\n    const token = Auth.loggedIn() ? Auth.getToken() : null;\r\n\r\n    if (!token) {\r\n      throw new Error('You are not authenticated to remove a book!');\r\n    }\r\n\r\n    try {\r\n      // const { data: updatedUser } = await removeBook({ variables: { bookId }, context: { headers: { Authorization: `Bearer ${token}` } } });\r\n\r\n       const { data } = await removeBook({\r\n         variables: { bookId },\r\n         context: { headers: { Authorization: `Bearer ${token}` } },\r\n       });\r\n\r\n    } catch (err) {\r\n      console.error(err);\r\n        throw new Error(`An error occurred removing the book! Error message: ${err.message}`);\r\n    }\r\n  };\r\n\r\n    \r\n  if (userLoading) {\r\n    return <h2>Loading...</h2>;\r\n  } else if (userError || !userData) {\r\n    console.error(userError);\r\n  }\r\n\r\n  // if data isn't here yet, say so\r\n  if (removeLoading) {\r\n    return <h2>LOADING...</h2>;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div fluid className='text-light bg-dark p-5'>\r\n        <Container>\r\n          <h1>Viewing saved books!</h1>\r\n        </Container>\r\n      </div>\r\n      <Container>\r\n        <h2 className='pt-5'>\r\n          {userData.me.savedBooks.length\r\n            ? `Viewing ${userData.me.savedBooks.length} saved ${userData.me.savedBooks.length === 1 ? 'book' : 'books'}:`\r\n            : 'You have no saved books!'}\r\n        </h2>\r\n        <Row>\r\n          {userData.me.savedBooks.map((book) => {\r\n            return (\r\n              <Col md=\"4\">\r\n                <Card key={book.bookId} border='dark'>\r\n                  {book.image ? <Card.Img src={book.image} alt={`The cover for ${book.title}`} variant='top' /> : null}\r\n                  <Card.Body>\r\n                    <Card.Title>{book.title}</Card.Title>\r\n                    <p className='small'>Authors: {book.authors}</p>\r\n                    <Card.Text>{book.description}</Card.Text>\r\n                    <Button className='btn-block btn-danger' onClick={() => handleDeleteBook(book.bookId)}>\r\n                      Delete this Book!\r\n                    </Button>\r\n                  </Card.Body>\r\n                </Card>\r\n              </Col>\r\n            );\r\n          })}\r\n        </Row>\r\n      </Container>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default SavedBooks;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}